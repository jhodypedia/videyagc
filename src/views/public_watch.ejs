<!doctype html>
<html lang="en">
<head>
  <%- include("partials/head", { settings, title: video.title, canonical: baseUrl + "/v/" + video.slug }) %>

  <meta name="description" content="<%= (video.description || video.title).slice(0, 160) %>">
  <meta property="og:type" content="video.other">
  <meta property="og:title" content="<%= video.title %>">
  <meta property="og:url" content="<%= baseUrl + "/v/" + video.slug %>">

  <script type="application/ld+json">
  <%- JSON.stringify({
    "@context":"https://schema.org",
    "@type":"VideoObject",
    "name": video.title,
    "description": (video.description || video.title).slice(0, 200),
    "uploadDate": video.createdAt,
    "contentUrl": baseUrl + "/stream/" + video.id,
    "embedUrl": baseUrl + "/v/" + video.slug
  }) %>
  </script>
</head>
<body class="min-h-screen bg-[#05070b] text-white">
  <%- include("partials/navbar", { settings }) %>

  <div class="max-w-5xl mx-auto px-4 py-6">
    <% if (ads.header) { %><div class="adbox mb-4"><%- ads.header %></div><% } %>

    <div class="grid grid-cols-1 lg:grid-cols-[1fr_320px] gap-4">
      <div>
        <div class="rounded-xl overflow-hidden border border-white/10 bg-black">
          <div class="relative">
            <video id="player" class="w-full h-auto" controls playsinline preload="metadata">
              <source src="/stream/<%= video.id %>" type="<%= video.mime %>">
            </video>

            <% if (ads.in_player) { %>
              <div class="absolute top-2 right-2 w-48 max-w-[45%] pointer-events-auto">
                <div class="adbox !bg-black/60"><%- ads.in_player %></div>
              </div>
            <% } %>
          </div>
        </div>

        <div class="mt-3">
          <h1 class="text-lg font-bold leading-snug"><%= video.title %></h1>
          <div class="text-xs text-white/50 mt-1"><%= video.views %> views â€¢ <%= new Date(video.createdAt).toLocaleString() %></div>

          <div class="mt-3 flex flex-wrap gap-2">
            <button class="btn" onclick="copyText('<%= baseUrl + "/v/" + video.slug %>')">Copy Link</button>
            <button class="btn" onclick="copyText('<iframe src=&quot;<%= baseUrl + "/v/" + video.slug %>&quot; width=&quot;560&quot; height=&quot;315&quot; frameborder=&quot;0&quot; allowfullscreen></iframe>')">Copy Embed</button>
          </div>

          <% if (video.description) { %>
          <p class="mt-3 text-sm text-white/75 leading-relaxed"><%= video.description %></p>
          <% } %>

          <% if (ads.below_player) { %>
            <div class="adbox mt-4"><%- ads.below_player %></div>
          <% } %>
        </div>
      </div>

      <aside>
        <% if (ads.sidebar) { %>
        <div class="adbox sticky top-20"><%- ads.sidebar %></div>
        <% } else { %>
        <div class="rounded-xl border border-white/10 bg-white/5 p-4 text-sm text-white/70">
          Tip: pasang Adsterra di slot sidebar + below player untuk RPM lebih stabil.
        </div>
        <% } %>
      </aside>
    </div>
  </div>

  <% if (ads.floating) { %>
    <div class="fixed bottom-3 left-1/2 -translate-x-1/2 w-[min(520px,92vw)] z-[999]">
      <div class="adbox"><%- ads.floating %></div>
    </div>
  <% } %>

  <%- include("partials/footer", { settings }) %>

  <script>
    function copyText(t){
      navigator.clipboard.writeText(t).then(()=>{
        toast("Copied!");
      }).catch(()=>{ alert("Copy failed"); });
    }
  </script>
</body>
</html>
