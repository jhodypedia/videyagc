<!doctype html>
<html>
<head><%- include("partials/head", { settings, title: "Videos" }) %></head>
<body class="min-h-screen bg-[#05070b] text-white">
  <%- include("partials/navbar", { settings }) %>

  <div class="max-w-5xl mx-auto px-4 py-6">
    <div class="flex gap-2 text-sm">
      <a class="btn" href="<%= ADMIN_PATH %>/">Dashboard</a>
      <a class="btn" href="<%= ADMIN_PATH %>/upload">Upload</a>
    </div>

    <div class="mt-4 rounded-2xl border border-white/10 bg-white/5 overflow-hidden">
      <div class="p-3 text-xs text-white/60">Manage videos</div>
      <div class="divide-y divide-white/10">
        <% videos.forEach(v => { %>
          <div class="p-3 flex flex-col sm:flex-row sm:items-center gap-2 justify-between">
            <div>
              <div class="font-semibold"><%= v.title %></div>
              <div class="text-xs text-white/50">
                /v/<%= v.slug %> • <%= v.views %> views • <%= v.is_published ? "published" : "hidden" %>
              </div>
            </div>
            <div class="flex gap-2">
              <a class="btn" href="<%= baseUrl %>/v/<%= v.slug %>" target="_blank">Open</a>

              <form method="post" action="<%= ADMIN_PATH %>/videos/<%= v.id %>/toggle">
                <input type="hidden" name="_csrf" value="<%= (typeof csrfToken !== "undefined") ? csrfToken : "" %>">
                <button class="btn"><%= v.is_published ? "Unpublish" : "Publish" %></button>
              </form>

              <form method="post" action="<%= ADMIN_PATH %>/videos/<%= v.id %>/delete" onsubmit="return confirm('Delete?')">
                <input type="hidden" name="_csrf" value="<%= (typeof csrfToken !== "undefined") ? csrfToken : "" %>">
                <button class="btn !border-red-500/30 !bg-red-500/10">Delete</button>
              </form>
            </div>
          </div>
        <% }) %>
      </div>
    </div>
  </div>

  <%- include("partials/footer", { settings }) %>
</body>
</html>
